{% extends "base.html" %}

{% block title %}API Documentation - NextProperty AI{% endblock %}

{% block meta_description %}Complete API documentation for NextProperty AI. Learn how to integrate our real estate data and AI insights into your applications.{% endblock %}

{% block content %}
<div class="container mt-5 pt-4">
    <!-- Header Section -->
    <section class="api-header mb-5">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h1 class="display-4 fw-bold text-primary mb-4">API Documentation</h1>
                <p class="lead mb-4">
                    Integrate NextProperty AI's powerful real estate data and insights into your applications. 
                    Our RESTful API provides access to property valuations, market trends, and AI-powered analytics.
                </p>
                <div class="api-stats d-flex gap-4 mb-4">
                    <div class="stat-item">
                        <h4 class="fw-bold text-warning">99.9%</h4>
                        <p class="text-muted">Uptime</p>
                    </div>
                    <div class="stat-item">
                        <h4 class="fw-bold text-warning">< 200ms</h4>
                        <p class="text-muted">Response Time</p>
                    </div>
                    <div class="stat-item">
                        <h4 class="fw-bold text-warning">50+</h4>
                        <p class="text-muted">Endpoints</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="api-visual text-center">
                    <i class="fas fa-code fa-8x text-primary mb-3"></i>
                    <h4 class="text-muted">RESTful API</h4>
                </div>
            </div>
        </div>
    </section>

    <!-- Quick Start -->
    <section class="quick-start mb-5">
        <div class="row">
            <div class="col-12 mb-4">
                <h2 class="fw-bold">Quick Start</h2>
                <p class="lead">Get started with the NextProperty AI API in minutes</p>
            </div>
        </div>
        <div class="row g-4">
            <div class="col-lg-6">
                <div class="step-card">
                    <div class="step-number">1</div>
                    <h5 class="fw-bold">Get API Key</h5>
                    <p>Sign up for a free account and generate your API key from the dashboard.</p>
                    <a href="{{ url_for('main.register') }}" class="btn btn-outline-primary">Sign Up</a>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="step-card">
                    <div class="step-number">2</div>
                    <h5 class="fw-bold">Make First Request</h5>
                    <p>Test the API with a simple property search request.</p>
                    <button class="btn btn-outline-success" onclick="copyCode('sample-request')">Copy Example</button>
                </div>
            </div>
        </div>
    </section>

    <!-- Authentication -->
    <section class="auth-section mb-5">
        <h2 class="fw-bold mb-4">Authentication</h2>
        <div class="auth-card">
            <h5 class="fw-bold">API Key Authentication</h5>
            <p>Include your API key in the request headers:</p>
            <div class="code-block" id="auth-example">
                <pre><code>curl -H "Authorization: Bearer YOUR_API_KEY" \
     -H "Content-Type: application/json" \
     https://api.nextproperty.ai/v1/properties</code></pre>
            </div>
            <button class="btn btn-sm btn-outline-primary mt-2" onclick="copyCode('auth-example')">
                <i class="fas fa-copy me-1"></i>Copy
            </button>
        </div>
    </section>

    <!-- Base URL -->
    <section class="base-url-section mb-5">
        <h2 class="fw-bold mb-4">Base URL</h2>
        <div class="url-card">
            <div class="url-display">
                <code class="h5">https://api.nextproperty.ai/v1/</code>
            </div>
            <p class="mt-3 mb-0">All API endpoints are relative to this base URL. The API uses HTTPS for secure communication.</p>
        </div>
    </section>

    <!-- Endpoints -->
    <section class="endpoints-section mb-5">
        <h2 class="fw-bold mb-4">API Endpoints</h2>
        
        <!-- Properties Endpoints -->
        <div class="endpoint-group mb-5">
            <h3 class="fw-bold text-primary mb-3">
                <i class="fas fa-home me-2"></i>Properties
            </h3>
            
            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <code>/properties</code>
                    <span class="description">Get all properties with filters</span>
                </div>
                <div class="endpoint-details">
                    <h6 class="fw-bold">Parameters:</h6>
                    <ul class="param-list">
                        <li><code>city</code> (string) - Filter by city</li>
                        <li><code>min_price</code> (number) - Minimum price</li>
                        <li><code>max_price</code> (number) - Maximum price</li>
                        <li><code>property_type</code> (string) - Property type filter</li>
                        <li><code>limit</code> (number) - Number of results (max 100)</li>
                    </ul>
                    <div class="code-block" id="properties-example">
                        <pre><code>GET /v1/properties?city=Toronto&min_price=500000&limit=10</code></pre>
                    </div>
                </div>
            </div>

            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <code>/properties/{id}</code>
                    <span class="description">Get specific property details</span>
                </div>
                <div class="endpoint-details">
                    <h6 class="fw-bold">Response includes:</h6>
                    <ul class="param-list">
                        <li>Property details and specifications</li>
                        <li>AI valuation and price prediction</li>
                        <li>Market analysis and investment metrics</li>
                        <li>Neighborhood insights</li>
                    </ul>
                </div>
            </div>

            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method post">POST</span>
                    <code>/properties/valuation</code>
                    <span class="description">Get AI property valuation</span>
                </div>
                <div class="endpoint-details">
                    <h6 class="fw-bold">Request Body:</h6>
                    <div class="code-block" id="valuation-example">
                        <pre><code>{
  "address": "123 Main St, Toronto, ON",
  "bedrooms": 3,
  "bathrooms": 2,
  "sqft": 1500,
  "property_type": "House"
}</code></pre>
                    </div>
                </div>
            </div>
        </div>

        <!-- Market Data Endpoints -->
        <div class="endpoint-group mb-5">
            <h3 class="fw-bold text-success mb-3">
                <i class="fas fa-chart-line me-2"></i>Market Data
            </h3>
            
            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <code>/market/trends</code>
                    <span class="description">Get market trends and indicators</span>
                </div>
                <div class="endpoint-details">
                    <h6 class="fw-bold">Parameters:</h6>
                    <ul class="param-list">
                        <li><code>city</code> (string) - Specific city analysis</li>
                        <li><code>period</code> (string) - Time period (1m, 3m, 6m, 1y)</li>
                        <li><code>property_type</code> (string) - Property type filter</li>
                    </ul>
                </div>
            </div>

            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <code>/market/economic-indicators</code>
                    <span class="description">Get economic indicators from Bank of Canada</span>
                </div>
            </div>

            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <code>/market/predictions</code>
                    <span class="description">Get AI market predictions</span>
                </div>
            </div>
        </div>

        <!-- Investment Analysis -->
        <div class="endpoint-group mb-5">
            <h3 class="fw-bold text-warning mb-3">
                <i class="fas fa-calculator me-2"></i>Investment Analysis
            </h3>
            
            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method get">GET</span>
                    <code>/investment/opportunities</code>
                    <span class="description">Get top investment opportunities</span>
                </div>
            </div>

            <div class="endpoint-card mb-3">
                <div class="endpoint-header">
                    <span class="method post">POST</span>
                    <code>/investment/analyze</code>
                    <span class="description">Analyze investment potential</span>
                </div>
                <div class="endpoint-details">
                    <div class="code-block" id="analyze-example">
                        <pre><code>{
  "property_id": "12345",
  "down_payment": 100000,
  "financing_rate": 0.035,
  "rental_income": 3500
}</code></pre>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Response Format -->
    <section class="response-format mb-5">
        <h2 class="fw-bold mb-4">Response Format</h2>
        <div class="format-card">
            <h5 class="fw-bold">Standard Response Structure</h5>
            <div class="code-block" id="response-example">
                <pre><code>{
  "success": true,
  "data": {
    // Response data
  },
  "meta": {
    "total": 150,
    "page": 1,
    "limit": 10,
    "pages": 15
  },
  "timestamp": "2025-06-15T10:30:00Z"
}</code></pre>
            </div>
        </div>

        <div class="format-card mt-4">
            <h5 class="fw-bold">Error Response Structure</h5>
            <div class="code-block" id="error-example">
                <pre><code>{
  "success": false,
  "error": {
    "code": "INVALID_PARAMETER",
    "message": "The 'city' parameter is required",
    "details": {}
  },
  "timestamp": "2025-06-15T10:30:00Z"
}</code></pre>
            </div>
        </div>
    </section>

    <!-- Rate Limits -->
    <section class="rate-limits mb-5">
        <h2 class="fw-bold mb-4">Rate Limits</h2>
        <div class="row g-4">
            <div class="col-lg-4">
                <div class="limit-card">
                    <h5 class="fw-bold text-success">Free Tier</h5>
                    <div class="limit-details">
                        <p class="h4">1,000</p>
                        <p class="text-muted">requests/month</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="limit-card">
                    <h5 class="fw-bold text-warning">Pro Tier</h5>
                    <div class="limit-details">
                        <p class="h4">10,000</p>
                        <p class="text-muted">requests/month</p>
                    </div>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="limit-card">
                    <h5 class="fw-bold text-primary">Enterprise</h5>
                    <div class="limit-details">
                        <p class="h4">Unlimited</p>
                        <p class="text-muted">Custom rates</p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- SDKs and Libraries -->
    <section class="sdks-section mb-5">
        <h2 class="fw-bold mb-4">SDKs & Libraries</h2>
        <div class="row g-4">
            <div class="col-lg-4">
                <div class="sdk-card">
                    <div class="sdk-icon">
                        <i class="fab fa-python fa-3x"></i>
                    </div>
                    <h5 class="fw-bold">Python SDK</h5>
                    <p>Official Python library for NextProperty AI API</p>
                    <div class="code-block" id="python-install">
                        <pre><code>pip install nextproperty-ai</code></pre>
                    </div>
                    <button class="btn btn-outline-primary btn-sm mt-2" onclick="copyCode('python-install')">
                        <i class="fas fa-copy me-1"></i>Copy
                    </button>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="sdk-card">
                    <div class="sdk-icon">
                        <i class="fab fa-js-square fa-3x"></i>
                    </div>
                    <h5 class="fw-bold">JavaScript SDK</h5>
                    <p>NPM package for Node.js and browser applications</p>
                    <div class="code-block" id="js-install">
                        <pre><code>npm install nextproperty-ai</code></pre>
                    </div>
                    <button class="btn btn-outline-primary btn-sm mt-2" onclick="copyCode('js-install')">
                        <i class="fas fa-copy me-1"></i>Copy
                    </button>
                </div>
            </div>
            <div class="col-lg-4">
                <div class="sdk-card">
                    <div class="sdk-icon">
                        <i class="fas fa-terminal fa-3x"></i>
                    </div>
                    <h5 class="fw-bold">REST API</h5>
                    <p>Direct HTTP requests for any programming language</p>
                    <div class="code-block" id="curl-example">
                        <pre><code>curl -X GET \
  https://api.nextproperty.ai/v1/properties</code></pre>
                    </div>
                    <button class="btn btn-outline-primary btn-sm mt-2" onclick="copyCode('curl-example')">
                        <i class="fas fa-copy me-1"></i>Copy
                    </button>
                </div>
            </div>
        </div>
    </section>

    <!-- Support -->
    <section class="api-support mb-5">
        <div class="row">
            <div class="col-12 mb-4">
                <h2 class="fw-bold">Developer Support</h2>
                <p class="lead">Need help integrating our API? We're here to assist you.</p>
            </div>
        </div>
        <div class="row g-4">
            <div class="col-lg-6">
                <div class="support-card">
                    <div class="support-icon">
                        <i class="fas fa-book"></i>
                    </div>
                    <h5 class="fw-bold">Documentation</h5>
                    <p>Comprehensive guides and examples</p>
                    <a href="#" class="btn btn-outline-primary">View Docs</a>
                </div>
            </div>
            <div class="col-lg-6">
                <div class="support-card">
                    <div class="support-icon">
                        <i class="fas fa-comments"></i>
                    </div>
                    <h5 class="fw-bold">Developer Forum</h5>
                    <p>Community support and discussions</p>
                    <a href="#" class="btn btn-outline-success">Join Forum</a>
                </div>
            </div>
        </div>
    </section>

    <!-- CTA -->
    <section class="api-cta bg-primary text-white p-5 rounded">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h3 class="fw-bold mb-3">Ready to Start Building?</h3>
                <p class="lead mb-0">
                    Get your API key and start integrating NextProperty AI into your applications today.
                </p>
            </div>
            <div class="col-lg-4 text-lg-end">
                <a href="{{ url_for('main.register') }}" class="btn btn-warning btn-lg">
                    <i class="fas fa-key me-2"></i>Get API Key
                </a>
            </div>
        </div>
    </section>
</div>

<style>
.api-header .stat-item {
    text-align: center;
}

.step-card {
    background: white;
    border-radius: 15px;
    padding: 2rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    text-align: center;
    height: 100%;
}

.step-number {
    width: 50px;
    height: 50px;
    background: linear-gradient(135deg, #007bff, #0056b3);
    color: white;
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
    margin: 0 auto 1rem;
}

.auth-card, .url-card, .format-card {
    background: white;
    border-radius: 15px;
    padding: 2rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
}

.url-display {
    background: #f8f9fa;
    padding: 1rem;
    border-radius: 8px;
    text-align: center;
    border: 2px dashed #dee2e6;
}

.endpoint-group {
    border-left: 4px solid #007bff;
    padding-left: 1.5rem;
    margin-left: 1rem;
}

.endpoint-card {
    background: white;
    border-radius: 10px;
    border: 1px solid #e9ecef;
    overflow: hidden;
}

.endpoint-header {
    background: #f8f9fa;
    padding: 1rem 1.5rem;
    display: flex;
    align-items: center;
    gap: 1rem;
    border-bottom: 1px solid #e9ecef;
}

.endpoint-details {
    padding: 1.5rem;
}

.method {
    padding: 0.25rem 0.75rem;
    border-radius: 4px;
    font-size: 0.875rem;
    font-weight: 600;
    color: white;
    min-width: 60px;
    text-align: center;
}

.method.get {
    background: #28a745;
}

.method.post {
    background: #007bff;
}

.method.put {
    background: #ffc107;
    color: #000;
}

.method.delete {
    background: #dc3545;
}

.code-block {
    background: #2d3748;
    color: #e2e8f0;
    padding: 1rem;
    border-radius: 8px;
    overflow-x: auto;
    position: relative;
}

.code-block pre {
    margin: 0;
    color: inherit;
}

.param-list {
    padding-left: 1.5rem;
}

.param-list li {
    margin-bottom: 0.5rem;
}

.param-list code {
    background: #f8f9fa;
    padding: 0.25rem 0.5rem;
    border-radius: 4px;
    color: #e83e8c;
    font-weight: 600;
}

.limit-card, .sdk-card, .support-card {
    background: white;
    border-radius: 15px;
    padding: 2rem;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    text-align: center;
    height: 100%;
}

.limit-details {
    margin-top: 1rem;
}

.sdk-icon, .support-icon {
    color: #007bff;
    margin-bottom: 1rem;
}

.sdk-icon i, .support-icon i {
    font-size: 3rem;
}

@media (max-width: 768px) {
    .endpoint-header {
        flex-direction: column;
        align-items: flex-start;
        gap: 0.5rem;
    }
    
    .method {
        align-self: flex-start;
    }
    
    .api-stats {
        flex-direction: column;
        gap: 1rem !important;
    }
}
</style>

<script>
function copyCode(elementId) {
    const element = document.getElementById(elementId);
    const code = element.innerText || element.textContent;
    
    navigator.clipboard.writeText(code).then(function() {
        // Show success feedback
        const button = event.target.closest('button');
        const originalText = button.innerHTML;
        button.innerHTML = '<i class="fas fa-check me-1"></i>Copied!';
        button.classList.remove('btn-outline-primary');
        button.classList.add('btn-success');
        
        setTimeout(() => {
            button.innerHTML = originalText;
            button.classList.remove('btn-success');
            button.classList.add('btn-outline-primary');
        }, 2000);
    }).catch(function(err) {
        console.error('Could not copy text: ', err);
        alert('Failed to copy to clipboard');
    });
}

// Add syntax highlighting effect
document.querySelectorAll('.code-block').forEach(block => {
    block.addEventListener('mouseenter', function() {
        this.style.boxShadow = '0 5px 20px rgba(0,123,255,0.3)';
    });
    
    block.addEventListener('mouseleave', function() {
        this.style.boxShadow = 'none';
    });
});
</script>
{% endblock %}
